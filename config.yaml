# yaml-language-server: $schema=./node_modules/envio/evm.schema.json
name: thj-indexer
contracts:
  - name: HoneyJar
    handler: src/EventHandlers.ts
    events:
      - event: Transfer(address indexed from, address indexed to, uint256 indexed tokenId)
        field_selection:
          transaction_fields:
            - hash
  - name: HoneyJar2Eth
    handler: src/EventHandlers.ts
    events:
      - event: Transfer(address indexed from, address indexed to, uint256 indexed tokenId)
        field_selection:
          transaction_fields:
            - hash
  - name: HoneyJar3Eth
    handler: src/EventHandlers.ts
    events:
      - event: Transfer(address indexed from, address indexed to, uint256 indexed tokenId)
        field_selection:
          transaction_fields:
            - hash
  - name: HoneyJar4Eth
    handler: src/EventHandlers.ts
    events:
      - event: Transfer(address indexed from, address indexed to, uint256 indexed tokenId)
        field_selection:
          transaction_fields:
            - hash
  - name: HoneyJar5Eth
    handler: src/EventHandlers.ts
    events:
      - event: Transfer(address indexed from, address indexed to, uint256 indexed tokenId)
        field_selection:
          transaction_fields:
            - hash
  - name: Honeycomb
    handler: src/EventHandlers.ts
    events:
      - event: Transfer(address indexed from, address indexed to, uint256 indexed tokenId)
        field_selection:
          transaction_fields:
            - hash
  - name: MoneycombVault
    handler: src/EventHandlers.ts
    events:
      - event: AccountOpened(address indexed user, uint256 indexed accountIndex, uint256 indexed honeycombId)
        field_selection:
          transaction_fields:
            - hash
      - event: AccountClosed(address indexed user, uint256 indexed accountIndex, uint256 indexed honeycombId)
        field_selection:
          transaction_fields:
            - hash
      - event: HJBurned(address indexed user, uint256 indexed accountIndex, uint256 indexed hjGen)
        field_selection:
          transaction_fields:
            - hash
      - event: SharesMinted(address indexed user, uint256 accountIndex, uint256 shares)
        field_selection:
          transaction_fields:
            - hash
      - event: RewardClaimed(address indexed user, uint256 reward)
        field_selection:
          transaction_fields:
            - hash
  # Henlo Token for burn tracking and holder tracking
  - name: HenloToken
    handler: src/EventHandlers.ts
    events:
      # Track ALL transfers for holder tracking and burns
      - event: Transfer(address indexed from, address indexed to, uint256 value)
        field_selection:
          transaction_fields:
            - hash
            - from
            - to
  # Aquabera Forwarder for wall tracking
  - name: AquaberaVault
    handler: src/EventHandlers.ts
    events:
      # Track deposits through the forwarder (DepositForwarded event)
      - event: DepositForwarded(address indexed sender, address indexed vault, address indexed token, uint256 amount, uint256 shares, address to)
        field_selection:
          transaction_fields:
            - hash
  # Direct Aquabera Vault events (for wall contract and other direct deposits)
  - name: AquaberaVaultDirect
    handler: src/EventHandlers.ts
    events:
      # Track direct deposits to vault (Uniswap V3 style pool)
      - event: Deposit(address indexed sender, address indexed to, uint256 shares, uint256 amount0, uint256 amount1)
        field_selection:
          transaction_fields:
            - hash
            - from
      # Track withdrawals from vault (Uniswap V3 style pool)
      - event: Withdraw(address indexed sender, address indexed to, uint256 shares, uint256 amount0, uint256 amount1)
        field_selection:
          transaction_fields:
            - hash
            - from
  # Crayons Factory emits new ERC721 collection deployments
  - name: CrayonsFactory
    handler: src/EventHandlers.ts
    events:
      - event: Factory__NewERC721Base(address indexed owner, address erc721Base)
        field_selection:
          transaction_fields:
            - hash
  # Crayons ERC721 collections emit transfers for holder tracking
  - name: CrayonsCollection
    handler: src/EventHandlers.ts
    events:
      - event: Transfer(address indexed from, address indexed to, uint256 indexed tokenId)
        field_selection:
          transaction_fields:
            - hash
  # Static ERC721 collections for holder tracking
  - name: TrackedErc721
    handler: src/EventHandlers.ts
    events:
      - event: Transfer(address indexed from, address indexed to, uint256 indexed tokenId)
        field_selection:
          transaction_fields:
            - hash
  # General ERC721 mint tracking (mint events only)
  - name: GeneralMints
    handler: src/EventHandlers.ts
    events:
      - event: Transfer(address indexed from, address indexed to, uint256 indexed tokenId)
        field_selection:
          transaction_fields:
            - hash
      # VM-specific: Capture encoded trait data from Minted event
      - event: Minted(address indexed user, uint256 tokenId, string traits)
        field_selection:
          transaction_fields:
            - hash
  - name: CandiesMarket1155
    handler: src/EventHandlers.ts
    events:
      - event: TransferSingle(address indexed operator, address indexed from, address indexed to, uint256 id, uint256 value)
        field_selection:
          transaction_fields:
            - hash
      - event: TransferBatch(address indexed operator, address indexed from, address indexed to, uint256[] ids, uint256[] values)
        field_selection:
          transaction_fields:
            - hash
  - name: CubBadges1155
    handler: src/EventHandlers.ts
    events:
      - event: TransferSingle(address indexed operator, address indexed from, address indexed to, uint256 id, uint256 value)
        field_selection:
          transaction_fields:
            - hash
      - event: TransferBatch(address indexed operator, address indexed from, address indexed to, uint256[] ids, uint256[] values)
        field_selection:
          transaction_fields:
            - hash
  # MiberaTrade - ERC721 NFT trading contract
  # MiberaTrade - Commented out until handlers are implemented
  # - name: MiberaTrade
  #   handler: src/EventHandlers.ts
  #   events:
  #     - event: TradeProposed(address indexed proposer, uint256 indexed offeredTokenId, uint256 indexed requestedTokenId, uint256 timestamp)
  #       field_selection:
  #         transaction_fields:
  #           - hash
  #     - event: TradeAccepted(address indexed acceptor, uint256 indexed offeredTokenId, uint256 indexed requestedTokenId, address originalProposer)
  #       field_selection:
  #         transaction_fields:
  #           - hash
  #     - event: TradeCancelled(address indexed canceller, uint256 indexed offeredTokenId, uint256 indexed requestedTokenId)
  #       field_selection:
  #         transaction_fields:
  #           - hash
  # CandiesTrade - ERC1155 Cargo/Drug trading contract - Commented out until handlers are implemented
  # - name: CandiesTrade
  #   handler: src/EventHandlers.ts
  #   events:
  #     - event: TradeProposed(address indexed proposer, uint256 indexed tradeId, uint256 offeredTokenId, uint256 offeredAmount, uint256 requestedTokenId, uint256 requestedAmount, address indexed requestedFrom, uint256 timestamp)
  #       field_selection:
  #         transaction_fields:
  #           - hash
  #     - event: TradeAccepted(address indexed acceptor, uint256 indexed tradeId, uint256 offeredTokenId, uint256 offeredAmount, uint256 requestedTokenId, uint256 requestedAmount, address originalProposer)
  #       field_selection:
  #         transaction_fields:
  #           - hash
  #     - event: TradeCancelled(address indexed canceller, uint256 indexed tradeId, uint256 offeredTokenId, uint256 offeredAmount, uint256 requestedTokenId, uint256 requestedAmount)
  #       field_selection:
  #         transaction_fields:
  #           - hash
  - name: FatBera
    handler: src/EventHandlers.ts
    events:
      - event: Deposit(address indexed from, address indexed to, uint256 amount, uint256 shares)
        field_selection:
          transaction_fields:
            - hash
            - from
  - name: BgtToken
    handler: src/EventHandlers.ts
    events:
      - event: QueueBoost(address indexed account, bytes indexed pubkey, uint128 amount)
        field_selection:
          transaction_fields:
            - hash
            - from
            - input

networks:
  # Ethereum Mainnet
  - id: 1
    start_block: 16751283 # Earliest block (Honeycomb)
    contracts:
      # Native HoneyJar contracts on Ethereum
      - name: HoneyJar
        address:
          - 0xa20cf9b0874c3e46b344deaeea9c2e0c3e1db37d # HoneyJar1
          - 0x98dc31a9648f04e23e4e36b0456d1951531c2a05 # HoneyJar6
      # Honeycomb on Ethereum
      - name: Honeycomb
        address:
          - 0xcb0477d1af5b8b05795d89d59f4667b59eae9244
      # Layer Zero reminted HoneyJar contracts on Ethereum
      - name: HoneyJar2Eth
        address:
          - 0x3f4dd25ba6fb6441bfd1a869cbda6a511966456d # HoneyJar2 L0 remint
      - name: HoneyJar3Eth
        address:
          - 0x49f3915a52e137e597d6bf11c73e78c68b082297 # HoneyJar3 L0 remint (was missing!)
      - name: HoneyJar4Eth
        address:
          - 0x0b820623485dcfb1c40a70c55755160f6a42186d # HoneyJar4 L0 remint (was missing!)
      - name: HoneyJar5Eth
        address:
          - 0x39eb35a84752b4bd3459083834af1267d276a54c # HoneyJar5 L0 remint (was missing!)

  # Arbitrum
  - id: 42161
    start_block: 102894033
    contracts:
      - name: HoneyJar
        address:
          - 0x1b2751328f41d1a0b91f3710edcd33e996591b72 # HoneyJar2

  # Zora
  - id: 7777777
    start_block: 18071873
    contracts:
      - name: HoneyJar
        address:
          - 0xe798c4d40bc050bc93c7f3b149a0dfe5cfc49fb0 # HoneyJar3

  # Optimism
  - id: 10
    start_block: 125752663
    contracts:
      - name: HoneyJar
        address:
          - 0xe1d16cc75c9f39a2e0f5131eb39d4b634b23f301 # HoneyJar4

  # Base
  - id: 8453
    start_block: 23252723
    contracts:
      - name: HoneyJar
        address:
          - 0xbad7b49d985bbfd3a22706c447fb625a28f048b4 # HoneyJar5

  # Berachain Mainnet (DO NOT CHANGE THIS ID)
  - id: 80094
    start_block: 866405 # Using the start block from the HoneyJar contracts
    contracts:
      # HenloToken on Berachain Mainnet for burn and holder tracking
      - name: HenloToken
        address:
          - 0xb2F776e9c1C926C4b2e54182Fac058dA9Af0B6A5 # Henlo token mainnet
      # AquaberaVault forwarder on Berachain Mainnet
      - name: AquaberaVault
        address:
          - 0xc0c6D4178410849eC9765B4267A73F4F64241832 # Aquabera forwarder (user deposits through UI)
      # Direct vault contract for wall deposits and withdrawals
      - name: AquaberaVaultDirect
        address:
          - 0x04fD6a7B02E2e48caedaD7135420604de5f834f8 # Aquabera HENLO/BERA vault (direct deposits/withdrawals)
      # HoneyJar contracts on Berachain Mainnet
      - name: HoneyJar
        address:
          - 0xedc5dfd6f37464cc91bbce572b6fe2c97f1bc7b3 # HoneyJar1 Bera
          - 0x1c6c24cac266c791c4ba789c3ec91f04331725bd # HoneyJar2 Bera
          - 0xf1e4a550772fabfc35b28b51eb8d0b6fcd1c4878 # HoneyJar3 Bera
          - 0xdb602ab4d6bd71c8d11542a9c8c936877a9a4f45 # HoneyJar4 Bera
          - 0x0263728e7f59f315c17d3c180aeade027a375f17 # HoneyJar5 Bera
          - 0xb62a9a21d98478f477e134e175fd2003c15cb83a # HoneyJar6 Bera
      # Honeycomb on Berachain Mainnet
      - name: Honeycomb
        address:
          - 0x886d2176d899796cd1affa07eff07b9b2b80f1be # Honeycomb Bera
      # MoneycombVault on Berachain Mainnet
      - name: MoneycombVault
        address:
          - 0x9279b2227b57f349a0ce552b25af341e735f6309

      # Crayons Factory (deploys ERC721 Base collections)
      - name: CrayonsFactory
        address:
          - 0xF1c7d49B39a5aCa29ead398ad9A7024ed6837F87

      # Crayons ERC721 Collections (Transfer indexing)
      - name: CrayonsCollection
        address: []
      # Static tracked ERC721 collections
      - name: TrackedErc721
        address:
          - 0x6666397DFe9a8c469BF65dc744CB1C733416c420 # mibera holders
          - 0x4B08a069381EfbB9f08C73D6B2e975C9BE3c4684 # tarot
          - 0x86Db98cf1b81E833447b12a077ac28c36b75c8E1 # miparcels
          - 0x8D4972bd5D2df474e71da6676a365fB549853991 # miladies
          - 0x144B27b1A267eE71989664b3907030Da84cc4754 # mireveal_1_1
          - 0x72DB992E18a1bf38111B1936DD723E82D0D96313 # mireveal_2_2
          - 0x3A00301B713be83EC54B7B4Fb0f86397d087E6d3 # mireveal_3_3
          - 0x419F25C4f9A9c730AAcf58b8401B5b3e566Fe886 # mireveal_4_20
          - 0x81A27117bd894942BA6737402fB9e57e942C6058 # mireveal_5_5
          - 0xaaB7b4502251aE393D0590bAB3e208E2d58F4813 # mireveal_6_6
          - 0xc64126EA8dC7626c16daA2A29D375C33fcaa4C7c # mireveal_7_7
          - 0x24F4047d372139de8DACbe79e2fC576291Ec3ffc # mireveal_8_8
      # General ERC721 Mint tracking (quest/missions)
      - name: GeneralMints
        address:
          - 0x048327A187b944ddac61c6e202BfccD20d17c008
          - 0x230945E0Ed56EF4dE871a6c0695De265DE23D8D8 # mibera_gif
          # NOTE: mibera_tarot handled by TrackedErc721 (which now creates mint actions too)
      - name: CandiesMarket1155
        address:
          - 0x80283fbF2b8E50f6Ddf9bfc4a90A8336Bc90E38F
          - 0xeca03517c5195f1edd634da6d690d6c72407c40c
      # MiberaTrade and CandiesTrade contracts commented out until handlers are implemented
      # - name: MiberaTrade
      #   address:
      #     - 0x90485B61C9dA51A3c79fca1277899d9CD5D350c2 # NFT trading contract
      # - name: CandiesTrade
      #   address: []
      #     # TODO: Add address after deployment
      #     # Contract will be deployed from /mibera-contracts/honey-road
      - name: CubBadges1155
        address:
          - 0x574617ab9788e614b3eb3f7bd61334720d9e1aac # Cub Universal Badges (mainnet)
          - 0x886d2176d899796cd1affa07eff07b9b2b80f1be # Legacy Artio deployment
      - name: FatBera
        address:
          - 0xBAE11292a3E693AF73651BDa350d752AE4A391d4
      - name: BgtToken
        address:
          - 0x656b95E550C07a9ffe548Bd4085c72418Ceb1dBa

# Enable multichain mode for cross-chain tracking
unordered_multichain_mode: true
preload_handlers: true
